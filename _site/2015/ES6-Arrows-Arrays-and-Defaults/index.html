<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Nick Balestra - 中文测试</title>
  <link rel="shortcut icon" href="/assets/images/favicon.png">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="Nick Balestra" href="/feed.xml">
  <link rel="stylesheet" href="/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href='/'> <span class="arrow">←</span> Home </a>
    

    
    <a href='/about'>About </a>
    
    <a class="cta" href="/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>中文测试</h1>
        <h2 class="headline">October 5, 2015</h2>
    </header>
    <section id="post-body">
        <h2>中文测试</h2>

<p>ECMAScript 2015 (6th Edition), commonly referred to as &quot;ES6&quot;, is the current version of the ECMAScript Language Specification standard.</p>

<p>In this post I go through leveraging some of its new feature to rewrite a recursive implementation of the document API method getElementsByClassName().  </p>

<hr>

<p>中文测试
getElementsByClassName() returns an array-like object of all child elements which have all of the given class names. When called on the document object, the complete document is searched, including the root node. You may also call getElementsByClassName() on any element; it will return only elements which are descendants of the specified root element with the given class names.</p>

<p>A recursive implementation could look something like this:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">getElementsByClassName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">node</span><span class="p">){</span>
<span class="lineno"> 2</span>   
<span class="lineno"> 3</span>   <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
<span class="lineno"> 4</span>   <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">className</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 7</span>     <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="lineno"> 8</span>   <span class="p">}</span>
<span class="lineno"> 9</span>   <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">childNode</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">10</span>     <span class="nx">results</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">childNode</span><span class="p">));</span>
<span class="lineno">11</span>   <span class="p">});</span>
<span class="lineno">12</span> 
<span class="lineno">13</span>   <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
<span class="lineno">14</span> <span class="p">};</span></code></pre></div>

<p>Let&#39;s see how ES6 could come handy:</p>

<h2>Arrows functions</h2>

<p>Arrow functions are always anonymous. Also known as fat arrow function, have a shorter syntax compared to function expressions and lexically binds the this value. Let&#39;s refactor the previous version using Arrow functions expressions instead:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">getElementsByClassName</span> <span class="o">=</span> <span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="lineno"> 2</span>   
<span class="lineno"> 3</span>   <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
<span class="lineno"> 4</span>   <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">className</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 7</span>     <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="lineno"> 8</span>   <span class="p">}</span>
<span class="lineno"> 9</span>   <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span> <span class="nx">childNode</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="lineno">10</span>     <span class="nx">results</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">childNode</span><span class="p">));</span>
<span class="lineno">11</span>   <span class="p">});</span>
<span class="lineno">12</span> 
<span class="lineno">13</span>   <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
<span class="lineno">14</span> <span class="p">};</span></code></pre></div>

<p>Not much but we shaved off some characters anyway.</p>

<h2>Array.from()</h2>

<p>We are all familiar with those array-like objects, especially if we deal with the DOM. The Array.from() method creates a new Array instance from an array-like or iterable object. Forgot about those? Here a refresher:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno">1</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">);</span>
<span class="lineno">2</span> <span class="c1">// &gt; false</span></code></pre></div>

<p>This is why in our earlier implementation we relied on underscore (_.each()) to iterate through that array-like object. Lets refactor again and get rid of that underscore dependency:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">getElementsByClassName</span> <span class="o">=</span> <span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="lineno"> 2</span>   
<span class="lineno"> 3</span>   <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
<span class="lineno"> 4</span>   <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">className</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 7</span>     <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="lineno"> 8</span>   <span class="p">}</span>
<span class="lineno"> 9</span>   
<span class="lineno">10</span>   <span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">childNode</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="lineno">11</span>     <span class="nx">results</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">childNode</span><span class="p">))</span>
<span class="lineno">12</span>   <span class="p">});</span>
<span class="lineno">13</span> 
<span class="lineno">14</span>   <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
<span class="lineno">15</span> <span class="p">};</span></code></pre></div>

<h2>Defaults</h2>

<p>In javascript we all rely on short-circuiting the OR operator to assign some default values to the function arguments, in case those were not definied. ES6 come with syntax sugar for this, allowing to set defaults directly within the function signature:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">getElementsByClassName</span> <span class="o">=</span> <span class="p">(</span><span class="nx">className</span><span class="p">,</span>  <span class="nx">node</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="lineno"> 2</span>   <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">className</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 5</span>     <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="lineno"> 6</span>   <span class="p">}</span>
<span class="lineno"> 7</span>     
<span class="lineno"> 8</span>   <span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">child</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="lineno"> 9</span>     <span class="nx">results</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span> <span class="nx">child</span><span class="p">))</span>
<span class="lineno">10</span>   <span class="p">});</span>
<span class="lineno">11</span>   
<span class="lineno">12</span>   <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
<span class="lineno">13</span> <span class="p">};</span></code></pre></div>

<p>To run and test ES6 code on chrome make sure you switch on the harmony setting. To do so, just enter in your chrome address bar the folloing url: <a href="chrome://flags/#enable-javascript-harmony">chrome://flags/#enable-javascript-harmony</a>.</p>

<p><strong>Note</strong> that defaults are not yet supported in chrome, therefore you won&#39;t be able to fully test this ES6 refactored solution out of the box. Because of that, I strongly encourage you to use the <a href="http://babeljs.io">babel</a> transpiler.</p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/nickbalestra">
        <img class="avatar" src="/assets/images/profile.png">
        <div>
            <span class="dark">Nick Balestra</span>
            <span>Software engineer</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=http://nick.balestra.ch/2015/ES6-Arrows-Arrays-and-Defaults/ - 中文测试 by @nickbalestra"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->

    <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'nickbalestra';
        var disqus_developer = 0; // developer mode is on
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


<!-- Archive -->

    <ul id="post-list" class="archive readmore">
        <h3>Read more</h3>
        
            <li>
                <a href="/2015/ES6-classes-and-prototype-based-inheritance/">JS's Prototype-based inheritance and classes demystified<aside class="dates">Oct 15</aside></a>
            </li>
        
            <li>
                <a href="/2015/depthFirst-vs-breadthFirst/">DepthFirst and breadthFirst tree walking<aside class="dates">Oct 10</aside></a>
            </li>
        
            <li>
                <a href="/2015/ES6-Arrows-Arrays-and-Defaults/">中文测试<aside class="dates">Oct 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/Installing-Ruby-Gems-Without-Sudo/">Install ruby gems without sudo on OSX<aside class="dates">Oct 04</aside></a>
            </li>
        
            <li>
                <a href="/2015/Installing-Node-Global/">Installing npm packages global on OSX<aside class="dates">Oct 04</aside></a>
            </li>
        
            <li>
                <a href="/2015/pick-your-parsing/">Pick your parsing<aside class="dates">Sep 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/sweetjs-case-macros-for-javascript/">Case based Macros for javaScript<aside class="dates">Aug 29</aside></a>
            </li>
        
            <li>
                <a href="/2015/hrb-sicp-studygroup/">HRB SICP Study group - Getting started with Lisp<aside class="dates">Aug 23</aside></a>
            </li>
        
            <li>
                <a href="/2015/for-loops-the-bad-the-good-the-ugly/">For* Loops: The Bad, The Good And The Ugly<aside class="dates">Aug 08</aside></a>
            </li>
        
            <li>
                <a href="/2015/build-a-simple-api-server-with-node/">Building a simple API server with node<aside class="dates">Jul 26</aside></a>
            </li>
        
            <li>
                <a href="/2015/Backbone-bindings-for-firebase/">Binding Backbone models & collections to Firebase<aside class="dates">Jul 24</aside></a>
            </li>
        
            <li>
                <a href="/2015/classes-and-instantiation-patterns-in-javascript/">Classes and Instantiation Patterns in javaScript<aside class="dates">Jul 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/Prefix-tree-data-structure/">Prefix Tree Data Structure<aside class="dates">Jul 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/javascript-functional-libraries/">JS Functional Programming Libraries<aside class="dates">Jun 13</aside></a>
            </li>
        
            <li>
                <a href="/2015/Kactus/">Kactus for Jekyll<aside class="dates">Jun 11</aside></a>
            </li>
        
            <li>
                <a href="/2015/IIFE/">The IIFE pattern<aside class="dates">Jun 08</aside></a>
            </li>
        
            <li>
                <a href="/2015/truthy-and-falsy/">Truthy and falsy values<aside class="dates">Jun 07</aside></a>
            </li>
        
            <li>
                <a href="/2015/prime-algos/">Trial division, Sieve of Eratosthenes and Factorization Wheel<aside class="dates">May 25</aside></a>
            </li>
        
            <li>
                <a href="/2015/using-every-to-return-some/">Using every() to return some()<aside class="dates">May 15</aside></a>
            </li>
        
            <li>
                <a href="/2015/jekyll-on-github-quick-guide/">Jekyll on Github - Quick guide<aside class="dates">May 10</aside></a>
            </li>
        
            <li>
                <a href="/2015/hackbot-a-js-robot-for-the-browser/">Hackbot - A js robot for the browser<aside class="dates">Jan 26</aside></a>
            </li>
        
            <li>
                <a href="/2015/intro-js-onboarding-api/">Intro.js onboarding API<aside class="dates">Jan 25</aside></a>
            </li>
        
            <li>
                <a href="/2015/javascripts-lexical-scope-hoisting-and-closures-without-mystery/">JavaScript’s lexical scope, hoisting and closures without mystery<aside class="dates">Jan 17</aside></a>
            </li>
        
    </ul>





  </section>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="/assets/js/main.js"></script>


  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-62842593-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
