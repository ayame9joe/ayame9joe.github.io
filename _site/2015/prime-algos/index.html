<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Nick Balestra - Trial division, Sieve of Eratosthenes and Factorization Wheel</title>
  <link rel="shortcut icon" href="/assets/images/favicon.png">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="Nick Balestra" href="/feed.xml">
  <link rel="stylesheet" href="/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href='/'> <span class="arrow">←</span> Home </a>
    

    
    <a href='/about'>About </a>
    
    <a class="cta" href="/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Trial division, Sieve of Eratosthenes and Factorization Wheel</h1>
        <h2 class="headline">May 25, 2015</h2>
    </header>
    <section id="post-body">
        <h2>In number theory, <strong>integer factorization</strong> is the decomposition of a composite number into a product of smaller integers. If these integers are further restricted to prime numbers, the process is called <strong>prime factorization</strong>.</h2>

<hr>

<p>Lets quickly walk through some basic integer factorization algorithms.</p>

<h3>Trial division</h3>

<p>The first among those algorithms, most laborious, but easiest to understand is the trial divison.</p>

<blockquote>
<p>Given an integer n (where n refers to &quot;the integer to be factored&quot;), trial division consists of systematically testing whether n is divisible by any smaller number</p>
</blockquote>

<p>If n is not divisible by any smaller number, then n is a prime. Lets put this algorithm into code:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno">1</span> <span class="kd">var</span> <span class="nx">isPrime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span>
<span class="lineno">2</span>   <span class="kd">var</span> <span class="nx">divisor</span><span class="p">;</span>
<span class="lineno">3</span>   <span class="k">for</span><span class="p">(</span><span class="nx">divisor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">divisor</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">divisor</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">4</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">%</span> <span class="nx">divisor</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">5</span>       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="lineno">6</span>     <span class="p">}</span>
<span class="lineno">7</span>   <span class="p">}</span>
<span class="lineno">8</span>   <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="lineno">9</span> <span class="p">};</span></code></pre></div>

<p>Furthermore, the trial factors need go no further than √n because, if n is divisible by some number p, then n = p × q and if q were smaller than p, n would have earlier been detected as being divisible by q or a prime factor of q.
We could then rewrite an optimised version of the isPrime function based on the trial division in the following way:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno">1</span> <span class="kd">var</span> <span class="nx">isPrime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span>
<span class="lineno">2</span>   <span class="kd">var</span> <span class="nx">divisor</span><span class="p">;</span>
<span class="lineno">3</span>   <span class="k">for</span><span class="p">(</span><span class="nx">divisor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">divisor</span> <span class="o">&lt;=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span> <span class="nx">divisor</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">4</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">%</span> <span class="nx">divisor</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">5</span>       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="lineno">6</span>     <span class="p">}</span>
<span class="lineno">7</span>   <span class="p">}</span>
<span class="lineno">8</span>   <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="lineno">9</span> <span class="p">};</span></code></pre></div>

<p>Understandably this algorythm can be pretty resource intensive. A better approach could be to sieve a set of numbers using one of the many sieve algorithms available, like for example the:</p>

<hr>

<h3>Sieve of Eratosthenes</h3>

<p>In mathematics, the sieve of Eratosthenes, one of a number of prime number sieves, is a simple, ancient algorithm for finding all prime numbers up to any given limit. It does so by iteratively marking as composite (i.e., not prime) the multiples of each prime, starting with the multiples of 2.</p>

<p>The algorythm can be braken down into the following steps:</p>

<ol>
<li>Create a list of consecutive integers from 2 through n: (2, 3, 4, ..., n).</li>
<li>Initially, let p equal 2, the first prime number.</li>
<li>Starting from p, enumerate its multiples by counting to n in increments of p, and mark them in the list (these will be 2p, 3p, 4p, ... ; the p itself should not be marked).</li>
<li>Find the first number greater than p in the list that is not marked. If there was no such number, stop. Otherwise, let p now equal this new number (which is the next prime), and repeat from step 3.</li>
</ol>

<p>Assuming we already have a list of consecutive integers from 2 through n, we could put the sieving into the following code:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">sieve</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span>   <span class="kd">var</span> <span class="nx">sieved</span> <span class="o">=</span> <span class="nx">list</span><span class="p">;</span>
<span class="lineno"> 4</span> 
<span class="lineno"> 5</span>   <span class="c1">// STEP 2 - Initially, let p equal 2, the first prime no.</span>
<span class="lineno"> 6</span>   <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span> <span class="o">||</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span>   <span class="c1">// STEP 3 - Starting from p, enumerate its multiples to n</span>
<span class="lineno"> 9</span>   <span class="c1">// in increments of p and remove them from the list.</span>
<span class="lineno">10</span>   <span class="c1">// p itself should not be removed.</span>
<span class="lineno">11</span>   <span class="kd">var</span> <span class="nx">init</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nx">p</span><span class="p">;</span>
<span class="lineno">12</span>   <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">sieved</span><span class="p">[</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
<span class="lineno">13</span>   <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">init</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">p</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">14</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">15</span>       <span class="nx">sieved</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno">16</span>     <span class="p">}</span>
<span class="lineno">17</span>   <span class="p">}</span>
<span class="lineno">18</span> 
<span class="lineno">19</span>   <span class="c1">// STEP 4 - Find the first unmarked number greater than p.</span>
<span class="lineno">20</span>   <span class="kd">var</span> <span class="nx">nextPrime</span> <span class="o">=</span> <span class="nx">sieved</span><span class="p">[</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="lineno">21</span> 
<span class="lineno">22</span>   <span class="c1">// If there was no such number, stop.</span>
<span class="lineno">23</span>   <span class="c1">// Otherwise, let p now equal this new number,</span>
<span class="lineno">24</span>   <span class="c1">// and epeat from step 3.</span>
<span class="lineno">25</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">nextPrime</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">26</span>     <span class="k">return</span> <span class="nx">sieve</span><span class="p">(</span><span class="nx">sieved</span><span class="p">,</span> <span class="nx">nextPrime</span><span class="p">);</span>
<span class="lineno">27</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">28</span>     <span class="k">return</span> <span class="nx">sieved</span><span class="p">;</span>
<span class="lineno">29</span>   <span class="p">}</span>
<span class="lineno">30</span> 
<span class="lineno">31</span> <span class="p">};</span></code></pre></div>

<p>Again, as the original algorithm suggest there are few optimization that could be done:</p>

<ul>
<li>As a refinement, it is sufficient to mark the numbers in step 3 starting from p^2, as all the smaller multiples of p will have already been marked at that point. This means that the algorithm is allowed to terminate in step 4 when p^2 is greater than n.</li>
<li>Another refinement is to initially list odd numbers only, (3, 5, ..., n), and count in increments of 2p in step 3, thus marking only odd multiples of p.</li>
</ul>

<p>and here the refined code:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="kd">var</span> <span class="nx">sieve</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oddList</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 2</span>   <span class="kd">var</span> <span class="nx">sieved</span> <span class="o">=</span> <span class="nx">oddList</span><span class="p">;</span>
<span class="lineno"> 3</span>   <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span> <span class="o">||</span> <span class="mi">3</span><span class="p">;</span>
<span class="lineno"> 4</span> 
<span class="lineno"> 5</span>   <span class="kd">var</span> <span class="nx">init</span> <span class="o">=</span> <span class="nx">p</span><span class="o">*</span><span class="nx">p</span><span class="p">;</span>
<span class="lineno"> 6</span>   <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">sieved</span><span class="p">[</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span>   <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">init</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">p</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 9</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">10</span>       <span class="nx">sieved</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno">11</span>     <span class="p">}</span>
<span class="lineno">12</span>   <span class="p">}</span>
<span class="lineno">13</span> 
<span class="lineno">14</span>   <span class="kd">var</span> <span class="nx">nextPrime</span> <span class="o">=</span> <span class="nx">sieved</span><span class="p">[</span><span class="nx">sieved</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="lineno">15</span> 
<span class="lineno">16</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="o">*</span><span class="nx">p</span> <span class="o">&gt;</span> <span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">17</span>     <span class="k">return</span> <span class="nx">sieved</span><span class="p">;</span>
<span class="lineno">18</span>   <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">nextPrime</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">19</span>     <span class="k">return</span> <span class="nx">sieve</span><span class="p">(</span><span class="nx">sieved</span><span class="p">,</span> <span class="nx">nextPrime</span><span class="p">);</span>
<span class="lineno">20</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">21</span>     <span class="k">return</span> <span class="nx">sieved</span><span class="p">;</span>
<span class="lineno">22</span>   <span class="p">}</span>
<span class="lineno">23</span> 
<span class="lineno">24</span> <span class="p">};</span></code></pre></div>

<p>As the sieving range gets larger, it is necessary to change the implementation to only sieve primes per page segment. In other words we should paginates the list to optimize for larger cases, and this is excactly what a <strong>wheel factorization</strong> algorithm does.</p>

<hr>

<p>Learn more about the <a href="http://en.wikipedia.org/wiki/Wheel_factorization">wheel factorization</a> and discover <a href="http://en.wikipedia.org/wiki/Integer_factorization">other interesting Integer factorization algos</a> like <a href="http://en.wikipedia.org/wiki/Fermat%27s_factorization_method">Fermat&#39;s</a>, <a href="http://en.wikipedia.org/wiki/Euler%27s_factorization_method">Euler&#39;s</a> and <a href="http://en.wikipedia.org/wiki/Dixon%27s_factorization_method">Dixon&#39;s</a></p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/nickbalestra">
        <img class="avatar" src="/assets/images/profile.png">
        <div>
            <span class="dark">Nick Balestra</span>
            <span>Software engineer</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=http://nick.balestra.ch/2015/prime-algos/ - Trial division, Sieve of Eratosthenes and Factorization Wheel by @nickbalestra"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->

    <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'nickbalestra';
        var disqus_developer = 0; // developer mode is on
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


<!-- Archive -->

    <ul id="post-list" class="archive readmore">
        <h3>Read more</h3>
        
            <li>
                <a href="/2015/ES6-classes-and-prototype-based-inheritance/">JS's Prototype-based inheritance and classes demystified<aside class="dates">Oct 15</aside></a>
            </li>
        
            <li>
                <a href="/2015/depthFirst-vs-breadthFirst/">DepthFirst and breadthFirst tree walking<aside class="dates">Oct 10</aside></a>
            </li>
        
            <li>
                <a href="/2015/ES6-Arrows-Arrays-and-Defaults/">中文测试<aside class="dates">Oct 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/Installing-Ruby-Gems-Without-Sudo/">Install ruby gems without sudo on OSX<aside class="dates">Oct 04</aside></a>
            </li>
        
            <li>
                <a href="/2015/Installing-Node-Global/">Installing npm packages global on OSX<aside class="dates">Oct 04</aside></a>
            </li>
        
            <li>
                <a href="/2015/pick-your-parsing/">Pick your parsing<aside class="dates">Sep 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/sweetjs-case-macros-for-javascript/">Case based Macros for javaScript<aside class="dates">Aug 29</aside></a>
            </li>
        
            <li>
                <a href="/2015/hrb-sicp-studygroup/">HRB SICP Study group - Getting started with Lisp<aside class="dates">Aug 23</aside></a>
            </li>
        
            <li>
                <a href="/2015/for-loops-the-bad-the-good-the-ugly/">For* Loops: The Bad, The Good And The Ugly<aside class="dates">Aug 08</aside></a>
            </li>
        
            <li>
                <a href="/2015/build-a-simple-api-server-with-node/">Building a simple API server with node<aside class="dates">Jul 26</aside></a>
            </li>
        
            <li>
                <a href="/2015/Backbone-bindings-for-firebase/">Binding Backbone models & collections to Firebase<aside class="dates">Jul 24</aside></a>
            </li>
        
            <li>
                <a href="/2015/classes-and-instantiation-patterns-in-javascript/">Classes and Instantiation Patterns in javaScript<aside class="dates">Jul 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/Prefix-tree-data-structure/">Prefix Tree Data Structure<aside class="dates">Jul 05</aside></a>
            </li>
        
            <li>
                <a href="/2015/javascript-functional-libraries/">JS Functional Programming Libraries<aside class="dates">Jun 13</aside></a>
            </li>
        
            <li>
                <a href="/2015/Kactus/">Kactus for Jekyll<aside class="dates">Jun 11</aside></a>
            </li>
        
            <li>
                <a href="/2015/IIFE/">The IIFE pattern<aside class="dates">Jun 08</aside></a>
            </li>
        
            <li>
                <a href="/2015/truthy-and-falsy/">Truthy and falsy values<aside class="dates">Jun 07</aside></a>
            </li>
        
            <li>
                <a href="/2015/prime-algos/">Trial division, Sieve of Eratosthenes and Factorization Wheel<aside class="dates">May 25</aside></a>
            </li>
        
            <li>
                <a href="/2015/using-every-to-return-some/">Using every() to return some()<aside class="dates">May 15</aside></a>
            </li>
        
            <li>
                <a href="/2015/jekyll-on-github-quick-guide/">Jekyll on Github - Quick guide<aside class="dates">May 10</aside></a>
            </li>
        
            <li>
                <a href="/2015/hackbot-a-js-robot-for-the-browser/">Hackbot - A js robot for the browser<aside class="dates">Jan 26</aside></a>
            </li>
        
            <li>
                <a href="/2015/intro-js-onboarding-api/">Intro.js onboarding API<aside class="dates">Jan 25</aside></a>
            </li>
        
            <li>
                <a href="/2015/javascripts-lexical-scope-hoisting-and-closures-without-mystery/">JavaScript’s lexical scope, hoisting and closures without mystery<aside class="dates">Jan 17</aside></a>
            </li>
        
    </ul>





  </section>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="/assets/js/main.js"></script>


  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-62842593-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
